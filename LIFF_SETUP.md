# LINE LIFF Setup Guide - ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LINE LIFF

## üìã ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°

### 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á LINE Login Channel
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [LINE Developers Console](https://developers.line.biz/console/)
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á Provider (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ)
3. ‡∏™‡∏£‡πâ‡∏≤‡∏á Channel ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó "LINE Login"
4. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Channel ID ‡πÅ‡∏•‡∏∞ Channel Secret

### 2. ‡∏™‡∏£‡πâ‡∏≤‡∏á LIFF App
1. ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Channel ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πá‡∏ö "LIFF"
2. ‡∏Ñ‡∏•‡∏¥‡∏Å "Add" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á LIFF App ‡πÉ‡∏´‡∏°‡πà
3. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:
   - **LIFF app name**: ‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏≠‡∏õ (‡πÄ‡∏ä‡πà‡∏ô "CheckInOut Employee")
   - **Size**: Full (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)
   - **Endpoint URL**: URL ‡∏Ç‡∏≠‡∏á‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô (‡πÄ‡∏ä‡πà‡∏ô `https://yourdomain.com/register`)
   - **Scope**: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å `profile` ‡πÅ‡∏•‡∏∞ `openid`
   - **Bot link feature**: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
4. ‡∏Ñ‡∏•‡∏¥‡∏Å "Add"
5. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å **LIFF ID** (‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: `1234567890-abcdefgh`)

### 3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variables

‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `.env.local` ‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå root ‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ:

```env
# LINE LIFF Configuration
NEXT_PUBLIC_LIFF_ID=your-liff-id-here

# Firebase Configuration (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
NEXT_PUBLIC_FIREBASE_API_KEY=your-api-key
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=your-auth-domain
NEXT_PUBLIC_FIREBASE_PROJECT_ID=your-project-id
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=your-storage-bucket
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=your-sender-id
NEXT_PUBLIC_FIREBASE_APP_ID=your-app-id
```

**‚ö†Ô∏è ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç**: ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà `your-liff-id-here` ‡∏î‡πâ‡∏ß‡∏¢ LIFF ID ‡∏ó‡∏µ‡πà‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏°‡∏≤

---

## üîß ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ get user ‡πÑ‡∏î‡πâ

#### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:

1. **‡πÄ‡∏õ‡∏¥‡∏î Browser Console** (‡∏Å‡∏î F12)
2. ‡∏î‡∏π Console Log ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏∞‡πÑ‡∏£:

   ```
   ‚úÖ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏´‡πá‡∏ô:
   - "Initializing LIFF..."
   - "LIFF ID: 1234567890-abcdefgh"
   - "LIFF initialized successfully"
   - "User is logged in"
   - "User profile: {userId: '...', displayName: '...', ...}"
   
   ‚ùå ‡∏ñ‡πâ‡∏≤‡πÄ‡∏´‡πá‡∏ô:
   - "LIFF SDK not loaded" ‚Üí LIFF SDK ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î
   - "LIFF ID not found" ‚Üí ‡πÑ‡∏°‡πà‡∏°‡∏µ LIFF ID ‡πÉ‡∏ô .env.local
   - "LIFF Initialization failed" ‚Üí ‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ initialize
   - "User is not logged in" ‚Üí ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ login
   ```

#### ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:

**1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö LIFF ID**
```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå .env.local ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
ls -la .env.local

# ‡∏î‡∏π‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå
cat .env.local
```

**2. Restart Dev Server**
```bash
# ‡∏´‡∏¢‡∏∏‡∏î server (Ctrl+C)
# ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà
npm run dev
```

**3. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏ô LINE App**
- LIFF ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏ú‡πà‡∏≤‡∏ô LINE App ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
- ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏ô browser ‡∏õ‡∏Å‡∏ï‡∏¥‡πÑ‡∏î‡πâ (‡∏à‡∏∞‡∏ñ‡∏π‡∏Å redirect ‡πÑ‡∏õ login)

**4. ‡πÉ‡∏ä‡πâ Mock Login ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Development**
- ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Register ‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏° "Mock Login" (‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô Bug)
- ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á Mock User ID ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö

---

## üß™ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏î‡∏™‡∏≠‡∏ö

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏ô Development (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ LINE)

1. ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ `/register`
2. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "Mock Login" (‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô Bug)
3. ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á Mock User ID ‡πÉ‡∏´‡πâ
4. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏ô LINE App (Production)

1. **‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code ‡∏´‡∏£‡∏∑‡∏≠ LIFF URL**:
   ```
   https://liff.line.me/{LIFF_ID}
   ```
   ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà `{LIFF_ID}` ‡∏î‡πâ‡∏ß‡∏¢ LIFF ID ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì

2. **‡πÄ‡∏õ‡∏¥‡∏î‡∏ú‡πà‡∏≤‡∏ô LINE**:
   - ‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡πÉ‡∏ô LINE App
   - ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡πà‡∏á URL ‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÉ‡∏ô LINE Chat ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏•‡∏¥‡∏Å

3. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö**:
   - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ç‡∏≠ permission ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å (‡πÉ‡∏´‡πâ‡∏Å‡∏î "Agree")
   - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• profile ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
   - ‡∏î‡∏π‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏°‡∏≤

---

## üì± LIFF URL Scheme

### URL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ:

```
# ‡∏´‡∏ô‡πâ‡∏≤ Register
https://liff.line.me/{LIFF_ID}/register

# ‡∏´‡∏ô‡πâ‡∏≤ Check-in
https://liff.line.me/{LIFF_ID}/check-in

# ‡∏´‡∏ô‡πâ‡∏≤ History
https://liff.line.me/{LIFF_ID}/history

# ‡∏´‡∏ô‡πâ‡∏≤ Leave Request
https://liff.line.me/{LIFF_ID}/leave-request

# ‡∏´‡∏ô‡πâ‡∏≤ OT Request
https://liff.line.me/{LIFF_ID}/ot-request
```

---

## üîê Security Best Practices

1. **‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢ LIFF ID**:
   - ‡πÅ‡∏°‡πâ‡∏ß‡πà‡∏≤ LIFF ID ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô public ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£ commit ‡∏•‡∏á Git
   - ‡πÉ‡∏ä‡πâ `.env.local` ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô `.gitignore`

2. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö User ID**:
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ User ID ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å LINE
   - ‡πÉ‡∏ä‡πâ Firebase Security Rules ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

3. **HTTPS Only**:
   - LIFF ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ HTTPS ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô localhost)
   - ‡πÉ‡∏ä‡πâ Vercel, Netlify ‡∏´‡∏£‡∏∑‡∏≠ Firebase Hosting ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö deploy

---

## üöÄ Deployment Checklist

- [ ] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LIFF ID ‡πÉ‡∏ô LINE Developers Console
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° LIFF ID ‡πÉ‡∏ô Environment Variables ‡∏Ç‡∏≠‡∏á hosting platform
- [ ] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Endpoint URL ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö production URL
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏õ‡∏¥‡∏î‡∏ú‡πà‡∏≤‡∏ô LINE App
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console Log ‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ error
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£ login ‡πÅ‡∏•‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• user

---

## üìû ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°

‡∏´‡∏≤‡∏Å‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠:
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console Log ‡πÉ‡∏ô Browser
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö LIFF ID ‡∏ß‡πà‡∏≤‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏ú‡πà‡∏≤‡∏ô LINE App
4. ‡∏•‡∏≠‡∏á Mock Login ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö
